<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Home Page</title>

    <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" type="text/css" />
    <link rel="stylesheet" href="/vendor/border-box.css" type="text/css" />
    <link rel="stylesheet" href="/styles/layout.css" type="text/css" />

    <script type="text/javascript" src="/vendor/jquery-3.0.0.js"></script>
    <script defer type="text/javascript" src="/scripts/app.js"></script>
    <script src="https://kit.fontawesome.com/77de315972.js" crossorigin="anonymous"></script>

  </head>
  <body>
    <%- include('partials/_header') %>
    <div class="greeting"><p style="padding-top: 120px;">What's hot right now</p></div>
    <div class="item-grid">
    <% const favouritesID = []; %>
    <% favourites.forEach(x => favouritesID.push(x['item_id'])); %>
    <% for (let item of items) { %>
      <% if (!item.is_sold && favouritesID.indexOf(item.id) === -1) { %>
      <% const capitalize = (s) => { %>
      <%  if (typeof s !== 'string') return '' %>
      <%  return s.charAt(0).toUpperCase() + s.slice(1) %>
      <% }   %>
      <script>
        function changeIcon(id) {
          event.stopPropagation();
          document.getElementById(id).innerHTML = '<i class="fas fa-heart" data-item="<%= item.id %>"></i>'
        }

    </script>
      <div class="item" style="background-image: url('<%= item.image_url %>')">
        <a href="http://localhost:8080/item/<%=item.id%>"><header><p style="font-weight: bold; font-size: large"><%= ("$" + item.price / 100) %></p><a onclick="changeIcon('<%= item.id %>')" id="<%= item.id %>"><i class="far fa-heart" data-item="<%= item.id %>"></i></a></header><footer><p style="font-weight: bold;"><%= capitalize(item.name) %></p></footer></a>
      </div>
    <% } else { %>
      <% const capitalize = (s) => { %>
      <%  if (typeof s !== 'string') return '' %>
      <%  return s.charAt(0).toUpperCase() + s.slice(1) %>
      <% }   %>
      <div class="item" style="background-image: url('<%= item.image_url %>')">
        <a href="http://localhost:8080/item/<%=item.id%>"><header><p style="font-weight: bold; font-size: large"><%= ("$" + item.price / 100) %></p><i class="fas fa-heart" data-item="<%= item.id %>"></i></header><footer><p style="font-weight: bold;"><%= capitalize(item.name) %></p></footer></a>
      </div>
    <% } }%>
    </div>
  </body>
</html>


